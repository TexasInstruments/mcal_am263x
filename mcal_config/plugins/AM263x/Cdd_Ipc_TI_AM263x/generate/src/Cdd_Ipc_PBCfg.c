/*
 * TEXAS INSTRUMENTS TEXT FILE LICENSE
 *
 * Copyright (c) 2022 Texas Instruments Incorporated
 *
 * All rights reserved not granted herein.
 *
 * Limited License.
 *
 * Texas Instruments Incorporated grants a world-wide, royalty-free, non-exclusive
 * license under copyrights and patents it now or hereafter owns or controls to
 * make, have made, use, import, offer to sell and sell ("Utilize") this software
 * subject to the terms herein. With respect to the foregoing patent license,
 * such license is granted solely to the extent that any such patent is necessary
 * to Utilize the software alone. The patent license shall not apply to any
 * combinations which include this software, other than combinations with devices
 * manufactured by or for TI ("TI Devices"). No hardware patent is licensed hereunder.
 *
 * Redistributions must preserve existing copyright notices and reproduce this license
 * (including the above copyright notice and the disclaimer and (if applicable) source
 * code license limitations below) in the documentation and/or other materials provided
 * with the distribution.
 *
 * Redistribution and use in binary form, without modification, are permitted provided
 * that the following conditions are met:
 * No reverse engineering, decompilation, or disassembly of this software is
 * permitted with respect to any software provided in binary form.
 * Any redistribution and use are licensed by TI for use only with TI Devices.
 * Nothing shall obligate TI to provide you with source code for the software
 * licensed and provided to you in object code.
 *
 * If software source code is provided to you, modification and redistribution of the
 * source code are permitted provided that the following conditions are met:
 * Any redistribution and use of the source code, including any resulting derivative
 * works, are licensed by TI for use only with TI Devices.
 * Any redistribution and use of any object code compiled from the source code
 * and any resulting derivative works, are licensed by TI for use only with TI Devices.
 *
 * Neither the name of Texas Instruments Incorporated nor the names of its suppliers
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * DISCLAIMER.
 *
 * THIS SOFTWARE IS PROVIDED BY TI AND TI'S LICENSORS "AS IS" AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL TI AND TI'S
 * LICENSORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 *  \file     Cdd_Ipc_PBCfg.c
 *
 *  \brief    This file contains generated post build configuration file
 *            for Complex device driver
 */

  /*********************************************************************************************************************
  Project: [!"$project"!]

    This file is generated by EB Tresos
    Do not modify this file, otherwise the software may behave in unexpected way.

 *********************************************************************************************************************/


#define CDD_PBCFG_SOURCE 1U

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "Cdd_Ipc.h"
#include "soc.h"

/**********************************************************************************************************************
 *  VERSION CHECK
 *********************************************************************************************************************/
#if (   (CDD_IPC_CFG_MAJOR_VERSION != ([!"substring-before($moduleSoftwareVer,'.')"!]U)) \
    || (CDD_IPC_CFG_MINOR_VERSION != ([!"substring-before(substring-after($moduleSoftwareVer,'.'),'.')"!]U)))
  #error "Version numbers of Cdd_Ipc_PbCfg.c and Cdd_Ipc_Cfg.h are inconsistent!"
#endif
[!AUTOSPACING!]
/**********************************************************************************************************************
 *  LOCAL CONSTANT MACROS
 **********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION MACROS
 **********************************************************************************************************************/
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRecvCallBackEnable = 'true'"!][!//
/* Recv CallBack Function Prototypes */
[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*"!][!//
[!LOOP "CddIpcEndPtConfig/*"!][!//
[!IF "node:empty(CddIpcRecvCallBack) or text:match(node:value(CddIpcRecvCallBack),'NULL_PTR')"!]
    [!ERROR!][!//
        "RpMsg Recv callback function cannot be NULL_PTR"[!//
    [!ENDERROR!][!//
[!ELSE!][!//
extern void [!"CddIpcRecvCallBack"!](void *handle, Cdd_Ipc_RPMessage_EpObject *epObj,[!IF "not(node:empty(CddIpcrecvCallbackArguments)) and not(text:match(node:value(CddIpcrecvCallbackArguments),'NULL_PTR'))"!]void* [!"CddIpcrecvCallbackArguments"!][!ELSE!]void* args[!ENDIF!], void *data, uint16 dataLen,sint32 crcStatus ,uint16 remoteCoreId, uint16 remoteEndPt);
[!ENDIF!]
[!ENDLOOP!][!//
[!ENDLOOP!][!//
[!ENDIF!][!//

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRecvNotifyCallbackEnable = 'true'"!][!//
/* Recv Notify CallBack Function prototypes */
[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*"!][!//
[!LOOP "CddIpcEndPtConfig/*"!][!//
[!IF "node:empty(CddIpcrecvNotifyCallback) or text:match(node:value(CddIpcrecvNotifyCallback),'NULL_PTR')"!][!//
    [!ERROR!][!//
        "RpMsg Notify Recv callback function cannot be NULL_PTR"[!//
    [!ENDERROR!][!//
[!ELSE!][!//
extern void [!"CddIpcrecvNotifyCallback"!](void *handle, Cdd_Ipc_RPMessage_EpObject *obj,[!IF "not(node:empty(CddIpcrecvNotifyCallbackArguments)) and not(text:match(node:value(CddIpcrecvNotifyCallbackArguments),'NULL_PTR'))"!]void* [!"CddIpcrecvNotifyCallbackArguments"!][!ELSE!]void* args[!ENDIF!]);
[!ENDIF!]
[!ENDLOOP!][!//
[!ENDLOOP!][!//
[!ENDIF!][!//

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcEnable = 'true'"!]
extern sint32 [!"as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcHookFunc"!](uint8 *data, uint16 dataLen, uint8 crcSize, void* crc);
[!ENDIF!]
/**********************************************************************************************************************
 *  LOCAL DATA TYPES AND STRUCTURES
 **********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL DATA PROTOTYPES
 **********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL DATA
 **********************************************************************************************************************/
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcSafeIpcEnable = 'false'"!][!//
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!][!//
#define CDD_IPC_START_SEC_VAR_NO_INIT_8
#include "Cdd_Ipc_MemMap.h"
[!IF "num:i(count(as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*)) = 3"!][!//
uint8 Cdd_RPMessageVringMem[12U][CDD_IPC_VRING_SIZE] __attribute__((aligned(128U), section("ipc_vring")));
[!ELSEIF "num:i(count(as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*)) = 2"!][!//
uint8 Cdd_RPMessageVringMem[6][CDD_IPC_VRING_SIZE] __attribute__((aligned(128), section("ipc_vring")));
[!ELSE!][!//
uint8 Cdd_RPMessageVringMem[2][CDD_IPC_VRING_SIZE] __attribute__((aligned(128), section("ipc_vring")));
[!ENDIF!]
#define  CDD_IPC_STOP_SEC_VAR_NO_INIT_8
#include "Cdd_Ipc_MemMap.h"
[!ENDIF!]
[!ENDIF!]

#define  CDD_IPC_START_SEC_CONFIG_DATA
#include "Cdd_Ipc_MemMap.h"

/*
 * Requirements : AUTORADAR_MCAL-66, AUTORADAR_MCAL-65
*/

[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*"!][!//
CONST(Cdd_IpcConfigType, CDD_PBCFG) Cdd_Ipc_Config =
{
[!WS "4"!].Cdd_Ipc_SelfCoreId = [!"as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId"!],
[!WS "4"!].Cdd_Ipc_numCores = [!"num:i(count(as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*))"!],
[!WS "4"!].Cdd_Ipc_coreIdList = {
[!WS "4"!][!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*"!][!//
[!WS "4"!][!"CddIpcRemoteCoreIdIndex"!],
[!WS "4"!][!ENDLOOP!][!//
[!WS "4"!]},
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!]
[!WS "4"!].Cdd_Ipc_RpMsgParams =
[!WS "4"!]{
[!WS "4"!][!LOOP "CddIpcEndPtConfig/*"!][!//
[!WS "4"!]
[!WS "8"!][[!"num:i(@index)"!]] =
[!WS "8"!]{
[!WS "8"!].Cdd_Ipc_localEndPt = [!"CddIpcLocalEndPt"!],
[!WS "8"!].recvCallback = [!IF "not(node:empty(CddIpcRecvCallBack))"!](Cdd_Ipc_RPMessage_lld_recvCallback)[!"CddIpcRecvCallBack"!][!ELSE!]NULL_PTR[!ENDIF!],
[!WS "8"!].recvCallbackArgs = [!IF "not(node:empty(CddIpcrecvCallbackArguments))"!][!"CddIpcrecvCallbackArguments"!][!ELSE!]NULL_PTR[!ENDIF!],
[!WS "8"!].recvNotifyCallback = [!IF "not(node:empty(CddIpcrecvNotifyCallback))"!](Cdd_Ipc_RPMessage_lld_recvNotifyCallback)[!"CddIpcrecvNotifyCallback"!][!ELSE!]NULL_PTR[!ENDIF!],
[!WS "8"!].recvNotifyCallbackArgs = [!IF "not(node:empty(CddIpcrecvNotifyCallbackArguments))"!][!"CddIpcrecvNotifyCallbackArguments"!][!ELSE!]NULL_PTR[!ENDIF!],
[!WS "8"!]},
[!ENDLOOP!][!//
[!WS "4"!]},
[!ENDIF!]
[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*"!][!//
    [!IF "CddIpcRemoteCoreIdIndex = as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId"!][!//
        [!ERROR!][!//
            "Remote Cores cannot be same as the local core, Please check the CddIpcRemoteCoreList to see none of the cores are matching with local core "[!//
        [!ENDERROR!][!//
    [!ENDIF!][!//
[!ENDLOOP!][!CR!][!//
[!ENDLOOP!][!//
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcEnable = 'false'"!]
[!WS "4"!].Cdd_Ipc_CrcHookFunc = NULL_PTR
[!ELSE!]
[!IF "node:empty(as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcHookFunc) or text:match(node:value(as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcHookFunc),'NULL_PTR')"!][!//
    [!ERROR!][!//
        "CRC callback function cannot be NULL_PTR when CRC is enabled"[!//
    [!ENDERROR!][!//
[!ELSE!][!//
[!WS "4"!].Cdd_Ipc_CrcHookFunc = [!"as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcCrcHookFunc"!]
[!ENDIF!]
[!ENDIF!]
};

P2CONST(Cdd_IpcConfigType, AUTOMATIC, CDD_PBCFG)CfgPtr = &Cdd_Ipc_Config;
#define  CDD_IPC_STOP_SEC_CONFIG_DATA
#include "Cdd_Ipc_MemMap.h"

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!][!//
/* IPC RPMessage init objects */
#define CDD_IPC_START_SEC_VAR_NO_INIT_UNSPECIFIED
#include "Cdd_Ipc_MemMap.h"
RPMessageLLD_InitObject CddIpc_RPMessageInitObj;
#define CDD_IPC_STOP_SEC_VAR_NO_INIT_UNSPECIFIED
#include "Cdd_Ipc_MemMap.h"
extern IpcNotify_Object CddIpc_NotifyObject;
[!ENDIF!]

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcSafeIpcEnable = 'false'"!][!//
[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!][!//
[!VAR "CORE_0" = "0"!]
[!VAR "CORE_1" = "0"!]
[!VAR "CORE_2" = "0"!]
[!VAR "CORE_3" = "0"!]
[!VAR "LOCAL_CORE" = "0"!]

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS0_0_ID'"!][!//
[!VAR "CORE_0" = "1"!]
[!VAR "LOCAL_CORE" = "0"!]
[!ELSEIF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS0_1_ID'"!][!//
[!VAR "CORE_1" = "1"!]
[!VAR "LOCAL_CORE" = "1"!]
[!ELSEIF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS1_0_ID'"!][!//
[!VAR "CORE_2" = "1"!]
[!VAR "LOCAL_CORE" = "2"!]
[!ELSE!]
[!VAR "CORE_3" = "1"!]
[!VAR "LOCAL_CORE" = "3"!]
[!ENDIF!][!//

[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*"!][!//
[!IF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS0_0_ID'"!][!//
[!VAR "CORE_0" = "1"!]
[!ELSEIF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS0_1_ID'"!][!//
[!VAR "CORE_1" = "1"!]
[!ELSEIF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS1_0_ID'"!][!//
[!VAR "CORE_2" = "1"!]
[!ELSE!]
[!VAR "CORE_3" = "1"!]
[!ENDIF!][!//
[!ENDLOOP!][!//
[!VAR "VringCount" = "0"!]

#define CDD_IPC_START_SEC_CODE
#include "Cdd_Ipc_MemMap.h"

void Cdd_Ipc_VringMemAllocation(void)
{
[!FOR "x" = "0" TO "3"!]
[!IF "(num:i($x) = '0' and num:i($CORE_0) = '1') or (num:i($x) = '1' and num:i($CORE_1) = '1') or (num:i($x) = '2' and num:i($CORE_2) = '1') or (num:i($x) = '3' and num:i($CORE_3) = '1') "!][!//
[!FOR "y" = "0" TO "3"!]
[!IF "(num:i($y) = '0' and num:i($CORE_0) = '1') or (num:i($y) = '1' and num:i($CORE_1) = '1') or (num:i($y) = '2' and num:i($CORE_2) = '1') or (num:i($y) = '3' and num:i($CORE_3) = '1') "!][!//
[!IF "num:i($x) != num:i($y)"!]
[!IF "num:i($LOCAL_CORE) = num:i($x)"!]
    CddIpc_RPMessageInitObj.vringTxBaseAddr[[!"num:i($y)"!]] = (uint32)Cdd_RPMessageVringMem[[!"num:i($VringCount)"!]];
[!ENDIF!]
[!IF "num:i($LOCAL_CORE) = num:i($y)"!]
    CddIpc_RPMessageInitObj.vringRxBaseAddr[[!"num:i($x)"!]] = (uint32)Cdd_RPMessageVringMem[[!"num:i($VringCount)"!]];
[!ENDIF!]
[!VAR "VringCount" = "num:i(num:add(1,text:split(num:i($VringCount))))"!]
[!ENDIF!][!//
[!ENDIF!][!//
[!ENDFOR!]
[!ENDIF!][!//
[!ENDFOR!]
    CddIpc_RPMessageInitObj.vringSize = CDD_IPC_VRING_SIZE;
    CddIpc_RPMessageInitObj.vringNumBuf = CDD_IPC_NUM_OF_BUFFERS;
    CddIpc_RPMessageInitObj.vringMsgSize = CDD_IPC_MAX_BUFFER_SIZE;
    CddIpc_RPMessageInitObj.hIpcNotify = &CddIpc_NotifyObject;
};
#define CDD_IPC_STOP_SEC_CODE
#include "Cdd_Ipc_MemMap.h"
[!ENDIF!][!//
[!ELSE!]

#define CDD_IPC_START_SEC_VAR_NO_INIT_8
#include "Cdd_Ipc_MemMap.h"
uint8 Cdd_Ipc_SharedMem[CDD_IPC_SHARED_MEMORY_SIZE] __attribute__((aligned(128), section("ipc_vring")));
#define  CDD_IPC_STOP_SEC_VAR_NO_INIT_8
#include "Cdd_Ipc_MemMap.h"

[!VAR "CORE_0" = "0"!]
[!VAR "CORE_1" = "0"!]
[!VAR "CORE_2" = "0"!]
[!VAR "CORE_3" = "0"!]
[!VAR "SAFECORE_0" = "0"!]
[!VAR "SAFECORE_1" = "0"!]
[!VAR "SAFECORE_2" = "0"!]
[!VAR "SAFECORE_3" = "0"!]
[!VAR "LOCAL_CORE" = "0"!]

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS0_0_ID'"!][!//
[!VAR "CORE_0" = "1"!]
[!VAR "SAFECORE_0" = "1"!]
[!VAR "LOCAL_CORE" = "0"!]
[!ELSEIF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS0_1_ID'"!][!//
[!VAR "CORE_1" = "1"!]
[!VAR "SAFECORE_1" = "1"!]
[!VAR "LOCAL_CORE" = "1"!]
[!ELSEIF "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcLocalCoreId = 'CDD_IPC_R5FSS1_0_ID'"!][!//
[!VAR "CORE_2" = "1"!]
[!VAR "SAFECORE_2" = "1"!]
[!VAR "LOCAL_CORE" = "2"!]
[!ELSE!][!//
[!VAR "CORE_3" = "1"!]
[!VAR "SAFECORE_3" = "1"!]
[!VAR "LOCAL_CORE" = "3"!]
[!ENDIF!][!//

[!LOOP "as:modconf('Cdd_Ipc')[1]/CddIpcDriver/*[1]/CddIpcRemoteCoreList/*"!][!//
[!IF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS0_0_ID'"!][!//
[!VAR "CORE_0" = "1"!]
[!IF "CddIpcSafeIpcCoresEnable = 'true'"!][!//
[!VAR "SAFECORE_0" = "1"!]
[!ENDIF!][!//
[!ELSEIF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS0_1_ID'"!][!//
[!VAR "CORE_1" = "1"!]
[!IF "CddIpcSafeIpcCoresEnable = 'true'"!][!//
[!VAR "SAFECORE_1" = "1"!]
[!ENDIF!][!//
[!ELSEIF "CddIpcRemoteCoreIdIndex = 'CDD_IPC_R5FSS1_0_ID'"!][!//
[!VAR "CORE_2" = "1"!]
[!IF "CddIpcSafeIpcCoresEnable = 'true'"!][!//
[!VAR "SAFECORE_2" = "1"!]
[!ENDIF!][!//
[!ELSE!]
[!VAR "CORE_3" = "1"!]
[!IF "CddIpcSafeIpcCoresEnable = 'true'"!][!//
[!VAR "SAFECORE_3" = "1"!]
[!ENDIF!][!//
[!ENDIF!][!//
[!ENDLOOP!][!//

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!]
[!VAR "VringSize" = "num:i(num:add(32,text:split(as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcMaxBufferSize)))"!]
[!VAR "VringSize" = "num:i(num:mul(as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcNumOfBuffers,text:split(num:i($VringSize))))"!]
[!VAR "VringSize" = "num:i(num:add(32,text:split(num:i($VringSize))))"!]
[!VAR "VringCount" = "0"!]
[!ENDIF!]
#define CDD_IPC_START_SEC_CODE
#include "Cdd_Ipc_MemMap.h"
void Cdd_Ipc_SafeIpcMemoryAllocation(IpcNotify_MailboxConfig *mailboxConfig)
{
    IpcNotify_MailboxConfig (*mailboxConfigPtr)[MCAL_CSL_CORE_ID_MAX] = (void *)mailboxConfig;
[!VAR "IpcSize" = "0"!]
[!VAR "NotifyCount" = "0"!]
[!VAR "Offset" = "0"!]
[!VAR "FirewallSize" = "0"!]
[!VAR "SharedMemory" ="0"!]
[!VAR "StartOffset" = "0"!]
[!FOR "x" = "0" TO "3"!]
[!IF "(num:i($x) = '0' and num:i($CORE_0) = '1') or (num:i($x) = '1' and num:i($CORE_1) = '1') or (num:i($x) = '2' and num:i($CORE_2) = '1') or (num:i($x) = '3' and num:i($CORE_3) = '1') "!][!//
[!FOR "y" = "$x+1" TO "3"!]
[!IF "(num:i($y) = '1' and num:i($CORE_1) = '1') or (num:i($y) = '2' and num:i($CORE_2) = '1') or (num:i($y) = '3' and num:i($CORE_3) = '1') "!][!//
[!VAR "NotifyCal1" = "num:i(num:mul(32,text:split(num:i($NotifyCount))))"!]
[!VAR "VringCal1" = "num:i(num:mul(text:split(num:i($VringCount)),text:split(num:i($VringSize))))"!]
[!VAR "NotifyCal1" = "num:i(num:add(text:split(num:i($NotifyCal1)),text:split(num:i($VringCal1))))"!]
[!VAR "NotifyCal1" = "num:i(num:add(text:split(num:i($NotifyCal1)),text:split(num:i($Offset))))"!]

[!IF "(num:i($x) = '0' and num:i($SAFECORE_0) = '1') or (num:i($x) = '1' and num:i($SAFECORE_1) = '1') or (num:i($x) = '2' and num:i($SAFECORE_2) = '1') or (num:i($x) = '3' and num:i($SAFECORE_3) = '1')"!][!//
[!IF "(num:i($y) = '1' and num:i($SAFECORE_1) = '1') or (num:i($y) = '2' and num:i($SAFECORE_2) = '1') or (num:i($y) = '3' and num:i($SAFECORE_3) = '1') "!][!//
[!VAR "CheckStartAddr" = "num:i(num:mod(text:split(num:i($NotifyCal1)),1024))"!]
[!IF "num:i($CheckStartAddr) != '0'"!][!//
[!VAR "StartOffset" = "num:i(num:sub(1024,text:split(num:i($CheckStartAddr))))"!]
[!VAR "SharedMemory" = "num:i(num:add(text:split(num:i($StartOffset)),text:split(num:i($SharedMemory))))"!]
[!VAR "Offset" = "num:i(num:add(text:split(num:i($StartOffset)),text:split(num:i($Offset))))"!]
[!VAR "NotifyCal1" = "num:i(num:add(text:split(num:i($StartOffset)),text:split(num:i($NotifyCal1))))"!]
[!ENDIF!][!//
[!ENDIF!][!//
[!ENDIF!][!//

    mailboxConfigPtr[[!"num:i($x)"!]][[!"num:i($y)"!]].swQ = (IpcNotify_SwQueue *)(&Cdd_Ipc_SharedMem[[!"num:i($NotifyCal1)"!]]);
    mailboxConfigPtr[[!"num:i($y)"!]][[!"num:i($x)"!]].swQ = (IpcNotify_SwQueue *)(&Cdd_Ipc_SharedMem[[!"num:i(num:add(32,text:split(num:i($NotifyCal1))))"!]]);
[!VAR "IpcSize" = "64"!]
[!VAR "NotifyCount" = "num:i(num:add(2,text:split(num:i($NotifyCount))))"!]

[!IF "as:modconf('Cdd_Ipc')[1]/CddIpcGeneral/CddIpcRpMsgEnable = 'true' "!][!//
[!VAR "VringCal" = "num:i(num:add(64,text:split(num:i($NotifyCal1))))"!]
[!IF "num:i($LOCAL_CORE) = num:i($x)"!]
    CddIpc_RPMessageInitObj.vringTxBaseAddr[[!"num:i($y)"!]] = (uintptr_t)(&Cdd_Ipc_SharedMem[[!"num:i($VringCal)"!]]);
    CddIpc_RPMessageInitObj.vringRxBaseAddr[[!"num:i($y)"!]] = (uintptr_t)(&Cdd_Ipc_SharedMem[[!"num:i(num:add(text:split(num:i($VringCal)),text:split(num:i($VringSize))))"!]]);
[!ENDIF!]
[!IF "num:i($LOCAL_CORE) = num:i($y)"!]
    CddIpc_RPMessageInitObj.vringRxBaseAddr[[!"num:i($x)"!]] = (uintptr_t)(&Cdd_Ipc_SharedMem[[!"num:i($VringCal)"!]]);
    CddIpc_RPMessageInitObj.vringTxBaseAddr[[!"num:i($x)"!]] = (uintptr_t)(&Cdd_Ipc_SharedMem[[!"num:i(num:add(text:split(num:i($VringCal)),text:split(num:i($VringSize))))"!]]);
[!ENDIF!]
[!VAR "IpcSize" = "num:i(num:add(text:split(num:i($IpcSize)),text:split(num:i($VringSize))))"!]
[!VAR "IpcSize" = "num:i(num:add(text:split(num:i($IpcSize)),text:split(num:i($VringSize))))"!]
[!VAR "VringCount" = "num:i(num:add(2,text:split(num:i($VringCount))))"!]
[!ENDIF!][!//

[!IF "((num:i($x) = '0' and num:i($SAFECORE_0) = '1') or (num:i($x) = '1' and num:i($SAFECORE_1) = '1') or (num:i($x) = '2' and num:i($SAFECORE_2) = '1') or (num:i($x) = '3' and num:i($SAFECORE_3) = '1')) and ((num:i($y) = '1' and num:i($SAFECORE_1) = '1') or (num:i($y) = '2' and num:i($SAFECORE_2) = '1')  or (num:i($y) = '3' and num:i($SAFECORE_3) = '1')) "!][!//
[!VAR "FirewallSize" = "num:i(num:div(text:split(num:i($IpcSize)),1024))"!]
[!VAR "FirewallSize" = "num:i(num:mul(text:split(num:i($FirewallSize)),1024))"!]
[!IF "num:i($IpcSize) < '1024' or num:i(num:mod(text:split(num:i($IpcSize)),1024)) != '0'"!][!//
[!VAR "FirewallSize" = "num:i(num:add(text:split(num:i($FirewallSize)),1024))"!]
[!ENDIF!][!//
[!VAR "Padding" = "num:i(num:sub(text:split(num:i($FirewallSize)),text:split(num:i($IpcSize))))"!]
[!VAR "Offset" = "num:i(num:add(text:split(num:i($Padding)),text:split(num:i($Offset))))"!]
[!VAR "SharedMemory" = "num:i(num:add(text:split(num:i($FirewallSize)),text:split(num:i($SharedMemory))))"!]
[!ELSE!]
[!VAR "SharedMemory" = "num:i(num:add(text:split(num:i($IpcSize)),text:split(num:i($SharedMemory))))"!]
[!ENDIF!][!//

[!ENDIF!][!//
[!ENDFOR!]
[!ENDIF!][!//
[!ENDFOR!]
    CddIpc_RPMessageInitObj.vringSize = CDD_IPC_VRING_SIZE;
    CddIpc_RPMessageInitObj.vringNumBuf = CDD_IPC_NUM_OF_BUFFERS;
    CddIpc_RPMessageInitObj.vringMsgSize = CDD_IPC_MAX_BUFFER_SIZE;
    CddIpc_RPMessageInitObj.hIpcNotify = &CddIpc_NotifyObject;
};
#define CDD_IPC_STOP_SEC_CODE
#include "Cdd_Ipc_MemMap.h"
[!ENDIF!][!//

/**********************************************************************************************************************
 *  END OF FILE: Cdd_PBcfg.c
 *********************************************************************************************************************/
