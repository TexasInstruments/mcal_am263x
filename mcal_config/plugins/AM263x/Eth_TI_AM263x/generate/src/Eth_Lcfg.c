[!IF "as:modconf('Eth')[1]/IMPLEMENTATION_CONFIG_VARIANT = 'VariantLinkTime'"!]
/* ======================================================================
 *   Copyright (c) 2022-2023 Texas Instruments Incorporated
 *
 *   All rights reserved. Property of Texas Instruments Incorporated.
 *   Restricted rights to use, duplicate or disclose this code are
 *   granted through contract.
 *
 *   The program may not be used without the written permission
 *   of Texas Instruments Incorporated or against the terms and conditions
 *   stipulated in the agreement under which this program has been
 *   supplied.
 * ==================================================================== */

 /**
 *  \file     Eth_Lcfg.c
 *
 *  \brief    This file contains generated link time configuration file
 *            for ETH MCAL driver
 */

/*******************************************************************************
    Project: [!"$project"!]
    This file is generated by EB Tresos
    Do not modify this file, otherwise the software may behave in unexpected way
*******************************************************************************/

/*******************************************************************************
 * Standard Header Files
 ******************************************************************************/

/*******************************************************************************
 * Other Header Files
 ******************************************************************************/
#include "Eth.h"

/*******************************************************************************
 *  Version Check
 ******************************************************************************/

/*  Version checking  */
#if ((ETH_SW_MAJOR_VERSION != ([!"substring-before($moduleSoftwareVer,'.')"!]U))||(ETH_SW_MINOR_VERSION != ([!"substring-before(substring-after($moduleSoftwareVer,'.'),'.')"!]U)))
  #error "Version numbers of Eth_Lcfg.c and Eth.h are inconsistent!"
#endif

#if ((ETH_CFG_MAJOR_VERSION != ([!"substring-before($moduleSoftwareVer,'.')"!]U)) || (ETH_CFG_MINOR_VERSION != ([!"substring-before(substring-after($moduleSoftwareVer,'.'),'.')"!]U)))
  #error "Version numbers of Eth_Lcfg.c and Eth_Cfg.h are inconsistent!"
#endif

/*******************************************************************************
 * Constants for Post-Build Configuration
 ******************************************************************************/
#define  ETH_START_SEC_CONFIG_DATA
#include "Eth_MemMap.h"

#ifdef __cplusplus
extern "C" {
#endif

[!AUTOSPACING!]

[!VAR "notifyFxnList" = "' '"!]
[!LOOP "as:modconf('Eth')[1]/EthConfigSet/EthCtrlConfig/*"!][!//
[!IF "not(node:empty(EthCacheFlushOps)) and not(text:match(EthCacheFlushOps,'NULL_PTR'))"!][!//
[!IF "not(node:containsValue(text:split($notifyFxnList),node:value(EthCacheFlushOps)))"!][!//
[!"concat('extern void ',EthCacheFlushOps,'(uint8 *BufPtr, uint32 LenByte);')"!]
[!VAR "notifyFxnList" = "concat($notifyFxnList,' ',EthCacheFlushOps)"!][!//
[!ENDIF!][!//
[!ENDIF!][!//
[!IF "not(node:empty(EthInvalidateOps)) and not(text:match(EthInvalidateOps,'NULL_PTR'))"!][!//
[!IF "not(node:containsValue(text:split($notifyFxnList),node:value(EthInvalidateOps)))"!][!//
[!"concat('extern void ',EthInvalidateOps,'(uint8 *BufPtr, uint32 LenByte);')"!]
[!VAR "notifyFxnList" = "concat($notifyFxnList,' ',EthInvalidateOps)"!][!//
[!ENDIF!][!//
[!ENDIF!][!//
[!ENDLOOP!][!//


/* generation of runtime configuration       */
/*<ETH_CONFIG>*/
[!LOOP "as:modconf('Eth')[1]/EthConfigSet/EthCtrlConfig/*"!]
[!IF "as:modconf('Eth')[1]/EthGeneral/EthTrafficShapingSupport = 'true'"!]
[!VAR "VarRateLimit" = "0"!]
[!ENDIF!]
VAR(struct Eth_ConfigType_s, ETH_LCFG)
    Eth_Config =
{
       .ctrlIdx = [!"EthCtrlIdx"!]U,
	   .portIdx = [!"EthPort"!],
       .portCfg =
       {
            .macCfg =
            {
                [!VAR "macModeFlag" = "'(0U '"!]
                [!LOOP "EthPortConfig/EthMacConfig/EthMacModeFlags/*"!]
                    [!VAR "macModeFlag"="concat($macModeFlag,' | ',.)"!]
                [!ENDLOOP!]
                [!VAR "macModeFlag"="concat($macModeFlag," )")"!]
                .macModeFlags = [!"$macModeFlag"!],
                .macConnectionType = (Eth_MacConnectionType)[!"EthPortConfig/EthMacConfig/EthMacConnectionType"!],
                .macAddr =
                {
                    [!IF "not(node:empty(EthCtrlPhyAddress/*))"!]
                    [!LOOP "text:split(EthCtrlPhyAddress/*,'-')"!]
                    0x[!"."!]U,
                    [!ENDLOOP!]
                    [!ELSE!]
                    NULL,NULL,NULL,NULL,NULL,NULL
                    [!ENDIF!]
                },
            },
            [!IF "as:modconf('Eth')[1]/EthGeneral/EthTrafficShapingSupport = 'true'"!][!//
            .shaperCfg =
            {
                [!VAR "ConfigCount" = "0"!][!//
                [!LOOP "EthCtrlConfigEgress/EthCtrlConfigShaper/*"!][!//
                {
                    .queueNum = (uint8)[!"node:ref(./EthCtrlConfigShaperPredecessorFifoRef)/EthCtrlConfigEgressFifoIdx"!]U,
                    .idleSlope = [!IF "not(node:empty(EthCtrlConfigShaperIdleSlope/__1))"!] (uint32)[!"EthCtrlConfigShaperIdleSlope/__1"!]U,[!ELSE!]0U,[!ENDIF!][!CR!]
                },
                [!VAR "ConfigCount" = "$ConfigCount+1"!][!//
                [!ENDLOOP!][!//
                [!FOR "x" = "$ConfigCount" TO "7"!][!//
                {
                    .queueNum = (uint8)ETH_PRIORITY_QUEUE_NUM, /* Invalid queue */
                    .idleSlope = 0U,
                },
                [!ENDFOR!][!//
            },
            [!ENDIF!][!//
       },

[!IF "EthCtrlEnableMii = 'true'"!]
#if (STD_ON == ETH_ENABLE_MII_API)
       .mdioCfg =
       {
           [!LOOP "EthMdioConfig/*"!]
           .mdioBusFreq = (uint32)[!"EthMdioBusFreq"!]U,
           .mdioClockFreq = (uint32) [!"EthMdioClockFreq"!]U
           [!ENDLOOP!]
       },
#endif
[!ENDIF!]
       .cpdmaCfg =
       {
            .pacingClkFreq = (uint32)[!"EthCpdmaConfig/EthPacingClkFreq"!]U,
            .rxInterruptPacingEnabled = (uint32) [!"text:toupper(EthCpdmaConfig/EthRxInterruptPacingEnabled)"!],
            .rxInterruptsPerMsec = [!"EthCpdmaConfig/EthRxInterruptPerMsec"!]U,
            .txInterruptPacingEnabled = (uint32) [!"text:toupper(EthCpdmaConfig/EthTxInterruptPacingEnabled)"!],
            .txInterruptsPerMsec = [!"EthCpdmaConfig/EthTxInterruptPerMsec"!]U,
            .dmaModeFlags = [!"EthCpdmaConfig/EthDmaModeFlags"!]U,
            .rxThreshCount = [!"EthCpdmaConfig/EthRxThresholdCount"!]U,
       },
#if (ETH_GLOBALTIMESUPPORT_API == STD_ON)
       .cptsCfg =
       {
           [!LOOP "EthCptsConfig/*"!]
           .cptsInputFreq = [!"EthCptsInputFreq"!]U,
           .vlanType      = [!"EthCptsVlanType"!],
           .msgTypeCfg    = (0U
                            [!LOOP "EthCptsMessageCfg/*"!]
                            | [!"EthCptsMessageCfgEnum"!]
                            [!ENDLOOP!]
                            )
           [!ENDLOOP!]
       },
#endif
       .enableCacheOps = (uint32)[!"text:toupper(string(EthEnableCacheOps))"!],
	   
       .cacheFlushOps = (Eth_CacheFlushType) [!IF "EthEnableCacheOps = 'true'"!][!"EthCacheFlushOps"!][!ELSE!]NULL_PTR[!ENDIF!],

       .cacheInvalidateOps = (Eth_CacheInvalidateType) [!IF "EthEnableCacheOps = 'true'"!][!"EthInvalidateOps"!][!ELSE!]NULL_PTR[!ENDIF!]
};
[!ENDLOOP!]
/*</ETH_CONFIG>*/

#ifdef __cplusplus
}
#endif
#define  ETH_STOP_SEC_CONFIG_DATA
#include "Eth_MemMap.h"

#define  ETH_START_SEC_VAR_INIT_UNSPECIFIED
#include "Eth_MemMap.h"
#ifdef __cplusplus
extern "C" {
#endif
/**
 *  \brief Eth  controller configuration set pointer
 */
P2CONST(Eth_ConfigType, ETH_VAR_NO_INIT, ETH_APPL_CONST) Eth_CfgPtr;

#ifdef __cplusplus
}
#endif
#define  ETH_STOP_SEC_VAR_INIT_UNSPECIFIED
#include "Eth_MemMap.h"

/*******************************************************************************
 *  End of File: Eth_Lcfg.c
 ******************************************************************************/
[!ELSE!]
/* The last generated configuration variant is not 
       LINK-TIME variant. Refer Eth_Cfg.c/Eth_PBcfg.c. */
[!ENDIF!]
