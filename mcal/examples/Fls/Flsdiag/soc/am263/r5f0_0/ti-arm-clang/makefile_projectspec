# Example makefile_projectspec for Adc project

# Define the path to the MCAL SDK
export MCAL_PATH?=$(abspath ../../../../../../..)

# Define the build profile (e.g., Release, Debug)
PROFILE?=Release

# Define the CCS Eclipse executable path (assuming CCS is being used)
CCS_ECLIPSE?=$(CCS_ECLIPSE_PATH)

# Define a command for creating directories
MKDIR := mkdir -p

# Command line variable for specifying the project name
PROJECT_NAME?=flsdiag_app

# Define the project specification file based on the project name
PROJECT_SPEC=$(PROJECT_NAME).projectspec

# Default target: Print a help message
all:
    @echo "Usage: make -f makefile_projectspec ccs_project PROJECT_NAME=<project_name> CCS_ECLIPSE_PATH=<path_to_ccs_eclipse> [PROFILE=<profile>]"

# Export target: Create or overwrite the specified project in CCS
export:
	@echo "Exporting project: $(PROJECT_NAME)"
	$(MKDIR) $(MCAL_PATH)/ccs_projects
	$(CCS_ECLIPSE) -noSplash -workspace $(MCAL_PATH)/ccs_projects -application com.ti.ccs.apps.projectCreate -ccs.projectSpec $(PROJECT_SPEC) -ccs.overwrite full

# CCS project target: Export the project first, then build it
ccs_project: export
	@echo "Building project: $(PROJECT_NAME)"
	$(CCS_ECLIPSE) -noSplash -workspace $(MCAL_PATH)/ccs_projects -application com.ti.ccs.apps.projectBuild -ccs.projects $(PROJECT_NAME) -ccs.configuration $(PROFILE)

# Clean target: Clean the specified project build artifacts
clean:
	@echo "Cleaning project: $(PROJECT_NAME)"
	$(CCS_ECLIPSE) -noSplash -workspace $(MCAL_PATH)/ccs_projects -application com.ti.ccs.apps.projectBuild -ccs.projects $(PROJECT_NAME) -ccs.configuration $(PROFILE) -ccs.clean

# Phony targets
.PHONY: all ccs_project clean export
