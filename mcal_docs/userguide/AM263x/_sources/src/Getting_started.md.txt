# Getting Started With AM263x MCAL

## Getting access to MCAL

AM263x MCAL can be requested from [ti.com](https://www.ti.com/tool/MCU-PLUS-SDK-AM263X)

## Package installer

None

## AM263x MCAL Overview

AM263x is an SOC from TI targeted to address various AUTOMOTIVE markets.
AUTOSAR is a key software which needs to run on ARM Cortex-R5 so that it can enable communication with other ECUs in the system.
TI needs to provide the MCAL drivers for the AUTOSAR to run on the SOCs.
Customers will need to procure the other AUTOSAR SW stack either internally or from third parties.

AM263x MCAL consists of three main components, Micro-controller abstraction layer (MCAL Driver code), Bare metal Example applications & EB Tresos studio Plugins.

- **drivers**: The drivers folder includes driver code of MCAL modules. The MCAL drivers implement the Software specification as mentioned in the AUTOSAR 4.3.1 release. It also contains basic software stubs and hardware register information.

- **examples**: The examples folder includes bare metal example applications for the MCAL driver modules that can be compiled and run on hardware.

- **plugins**: The plugins folder includes plugins for the MCAL modules that can be loaded, compiled and generate configuration files with EB Tresos Studio software.

## Folder structure

ğŸ“¦AM263x\
 â”£ ğŸ“‚build              : *Make files for building the MCAL library. MCAL supports make based build*\
 â”£ ğŸ“‚**mcal**\
 â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”ƒ â”£ ğŸ“‚include\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName.h : *Contains the API declarations of the driver to be used by upper layers*\
 â”ƒ â”ƒ â”£ ğŸ“‚src\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName.c : *Contains the implementation of the APIâ€™s for driver*\
 â”ƒ â”ƒ â”£ ğŸ“‚Vx        : *Contains other supporting SOC files for driver*\
 â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”£ ğŸ“‚autosar_include : *These included files part of the AUTOSAR BSW core. These should replace with the header files part of the AUTOSAR stack into which the MCAL is integrated*\
 â”ƒ â”£ ğŸ“‚**examples**    : *The contents of this directory SHOULD NOT be used in an AUTOSAR stack integration. It contains the utility API's for ISR's and enabling/disabling interrupts used, commonly across the examples when used in a non-AUTOSAR context*\
 â”ƒ â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚soc\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleNameApp.c : *Contains test example*\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleNameApp.h : *Contains example header file*\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”£ ğŸ“‚examples_config\
 â”ƒ â”ƒ â”£ ğŸ“‚ModuleName_Demo_Cfg\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚soc\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚am263\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚r5f0_0\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚include\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”—ğŸ“œModuleName_Cfg.h : *Contains the configuration parameters*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚src\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName_Cfg/PBCfg/Lcfg.c : *Contains all Pre-Compile/Post build/Link Time  Configured parameters*\
 â”£ ğŸ“‚mcal_config\
 â”ƒ â”£ ğŸ“‚**plugins**\
 â”ƒ â”ƒ â”£ ğŸ“‚AM263x\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ModuleName_TI_AM263x\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚config\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleName.arxml : *Vendor Specific Module Description : ECU Configuration and ECU Parameter definitions for the MCAL module*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleName.xdm : *ECU Parameter definition for the MCAL module.*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName_NonEB.xdm : *ECU Parameter definition for the NON EB*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚config_ext\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”—ğŸ“œModuleName_Rec.xdm : *Sample ECU Parameter definition for the MCAL module.*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚generate\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚include\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName_Cfg.h : *Provides template to generate header file*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚src\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleName_Cfg.c : *Provides template to generate Compile Time module configurations*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œModuleName_PBCfg.c : *Provides template to generate Post Build module configurations*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚generate_swcd\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚swcd\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”—ğŸ“œModuleName_BSWMD.arxml :*Base Software Module Description : Contains details such exclusive area, Module Entries, Interrupts, MemMap etc...*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚META-INF\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCRYPTOMANIFEST.MF\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCRYPTOMANIFESTSIG.MF\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”—ğŸ“œMANIFEST.MF : *Licensing and module include information*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œplugin.xml : *XML file used to register resources with EB Tresos Studio*\
 â”£ ğŸ“‚mcal_docs\
 â”ƒ â”£ ğŸ“‚csp  : *Contains test reports of all supported modules*\
 â”ƒ â”— ğŸ“‚userguide  : *Contains userguide of all supported modules*\
 â”— ğŸ“œREADME.txt

## Getting access to CSP

Will be added in later release.

## Compiler and Linker Settings

### Compiler Variants

MCAL package can be built with the following compiler variant: **TI ARM CLANG 4.0.0.LTS**.

Users can build with either compiler variants.

**gmake all PLATFORM=am263 PROFILE=<release/debug> COMPILER_VARIANT=\<CLANG>**

COMPILER_VARIANT can take the following value(s): **CLANG**

If COMPILER_VARIANT is not specified during the build, MCAL will be built for CLANG by default.

### Compiler Options

Below are the compiler flags used:

```{csv-table}
:header-rows: 1
:file: Assets/tables/Compiler_options_am263.csv

```

### Linker Options

Below are the linker flags used

Linker Options   | Description  |
---------|-----------|
â€“emit_warnings_as_errors -WL|Treats warnings as errors|
â€“warn_sections|Displays a message when an undefined output section is created|
-qq|Super quiet mode(quiet: Suppresses progress messages)|
â€“diag_suppress=10068|suppress error â€œno matching sectionâ€|
-mcpu=cortex-r5|ARM R5 architecture|
â€“diag_suppress=10063|supresses â€˜warning: entry point other than _c_int00 specified|
â€“ram_model|Initializes variables at load time|
â€“reread_libs -wl|Forces rereading of libraries, which resolves back references|

## Modules Supported

A set of MCAL included in the package each controlling a specific peripheral. MCAL drivers included are

Driver   | Comments  |
---------|-----------|
MCU |  Driver to control enabling of modules, PLL setting and basic microcontroller initialization |  
PORT|  Driver for control of PinMux |  
SPI |  SPI handler and driver for Serial Peripheral Interfaces: McSPI |
CAN |  Driver for the on-chip MCAN controller peripheral |
GPT |  Driver that controls the internal timer of the controller  |
WDG |  Driver for controlling the watchdog when controller goes into continuous loop  |
DIO |  Driver to read and write the data from the Channels / Port  |
FLS |  Driver provides services for reading, writing, erasing flash memory for external flash device  |
ETH |  Driver provides services to transmit and receive data with the external devices  |
ETHTRCV |  Driver for Physical Layer Transceiver  |
ADC |  Driver converts the analog value applied to ADC pin to its equivalent digital value  |
PWM |  Driver provides the pulse width modulated signal  |
EPWM |  Driver provides the enhanced pulse width modulated signal  |
ICU |  The ICU driver is a module using the input capture unit (ICU) counting pulses, measuring of frequency and duty cycle |
IPC  |  Make the initialization of mailbox driver and provides read and write APIs to perform inter processor communication  |
UART |  Driver provides serial communication using UART  |
I2C |  Driver provides support for transferring data between an external I2C device and the chip running this driver  |
DMA |  Provides direct memory access  |
FsiRx |  Provides fast serial data reception service  with the external devices  |
FsiTx |  Provides fast serial data transmission service  with the external devices  |
LIN |  Driver for the on-chip Lin controller peripheral|
CMPSS |  Driver consists of analog comparators and supporting circuits that are useful for power applications|

The MCAL drivers implement the Software specification as mentioned in the AUTOSAR 4.3.1 release.
Additionally, examples to demonstrate MCAL driver usages have also been included.

## Multi-core support

### Supported Devices/Platforms

AM263x: This release supports AM263x SoC

### Core Naming Conventions

SoC Family  | Cores Names     | Referred as  | Comments |
------------|-----------------|--------------|----------|
AM263x | CORTEX_R5_0 | R5_0 | Supported in AM263x MCAL |
AM263x | CORTEX_R5_1 | R5_1 | Not supported in AM263x MCAL |
AM263x | CORTEX_R5_2 | R5_2 | Not supported in AM263x MCAL |
AM263x | CORTEX_R5_3 | R5_3 | Not supported in AM263x MCAL |

## Dependencies

### Hardware Dependencies

#### Hardware Setup

List of hardware required for AM263x EVM:

1.AM263x CC / EVM

2.5V 3Amp USB Type-C Power Adaptor.

3.Micro USB Cable.

#### Cable Connections

Important cable connections, ports and switches.

##### AM263X-CC

1.System Power On/Off

- 5V power through Type-C 5V/3A

- HSEC 5V power is available only if Type-C is unavailable

- No mechanical on/off switch on this EVM

```{figure} Assets/images/mcaluserguide/Am263_cc.png
:alt: AM263_CC
:align: center


AM263_CC
```

#### Setup UART Terminal

##### AM263X-CC

1.Many examples use a standard UART terminal to log the output from the examples. You can use any UART terminal program for the same. Below steps show how to setup the UART terminal from CCS.

2.First identify the UART port as enumerated on the host machine.

- Make sure that the EVM and UART cable connected as shown in [Cable Connections](#cable-connections)
- In windows, you can use the "Device Manager" to see the detected UART ports
- Search "Device Manager" in Windows Search Box in the Windows taskbar.
- If you don't see any USB serial ports listed in "Device Manager" under "Ports (COM & LPT)", then make sure you have installed the UART to USB driver from FTDI, [https://www.ftdichip.com/FTDrivers.htm](https://www.ftdichip.com/FTDrivers.htm).

```{figure} Assets/images/mcaluserguide/Uart-pin.png
:alt: Identify UART Port in Windows Device Manager
:align: center


Identify UART Port in Windows Device Manager
```

3.In CCS, goto "View > Terminal"

```{figure} Assets/images/mcaluserguide/Terminal.png
:alt: UART Terminal Menu
:align: center


UART Terminal Menu
```

4.Open a new UART terminal

```{figure} Assets/images/mcaluserguide/Uart_terminal.png
:alt: Open New UART Terminal
:align: center


Open New UART Terminal
```

5.Select the UART port, keep other options to default, i.e 115200 baud rate - 8 data bits - No parity - 1 stop bit,

- We use this serial port, as seen in the device manager, for below in the SDK
- Flashing application via UART
- Booting application via UART
- Console output for examples

```{figure} Assets/images/mcaluserguide/Launch_Terminal.png
:alt: Connect to UART port
:align: center


Connect to UART port
```

6.In this screenshot this happens to be COM5/COM11 however on your machine this could be different. One tip to make sure there is no mistake in identifying the UART port is to disconnect all other UART to USB devices other than this EVM before checking in device manager.

### Software Dependencies

#### IDE (CCS)

Code Composer Studio is an integrated development environment (IDE) that supports TI's Micro-controller and Embedded Processors portfolio.

```{Note}
Please refer release notes for CCS version details.
 ```

You can downloaded CCS from [ti.com](https://www.ti.com/tool/CCSTUDIO#downloads)

### CCS Setup

If user does not have a functional setup using CCS, then the instructions in this section are relevant.

#### Installation Steps

1.Use TI CCS v12.1.0 or later

2.After the package is downloaded, you will be prompted to restart CCS to complete the installation.

3.The installer will install the Emulation package and complete installation.

## Start-up & AppUtils

### Start-up code

ğŸ“¦AM263x\
 â”£ ğŸ“‚build\
 â”£ ğŸ“‚mcal\
 â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”£ ğŸ“‚autosar_include\
 â”ƒ â”£ ğŸ“‚examples\
 â”ƒ â”£ ğŸ“‚examples_config\
 â”ƒ â”£ ğŸ“‚**include** : *Contains the Startup Code*\
 â”£ ğŸ“‚mcal_config\
 â”£ ğŸ“‚mcal_docs\
 â”— ğŸ“œREADME.txt

```{Attention}
Start-up code is for reference only, it should not be used as-is in a typical AUTOSAR applications.
 ```

### Apputils

ğŸ“¦AM263x\
 â”£ ğŸ“‚build\
 â”£ ğŸ“‚mcal\
 â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”£ ğŸ“‚autosar_include\
 â”ƒ â”£ ğŸ“‚examples\
 â”ƒ â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”ƒ â”£ ğŸ“‚**Utils** : *Contains AppUtils functions*\
 â”ƒ â”£ ğŸ“‚examples_config\
 â”ƒ â”£ ğŸ“‚include\
 â”£ ğŸ“‚mcal_config\
 â”£ ğŸ“‚mcal_docs\
 â”— ğŸ“œREADME.txt

```{Attention}
AppUtils source code is for reference only, it should not be used as-is in a typical AUTOSAR applications.
 ```

## Build system

### AM26x MCAL Make Architecture

ğŸ“¦AM263x\
 â”£ ğŸ“‚build\
 â”ƒ â”£ ğŸ“‚bootimage_scripts\
 â”ƒ â”£ ğŸ“‚makerules\
 â”ƒ â”ƒ â”£ ğŸ“œbuild_config.mk\
 â”ƒ â”ƒ â”£ ğŸ“œbuild_config_CLANG.mk\
 â”ƒ â”ƒ â”£ ğŸ“œcommon.mk\
 â”ƒ â”ƒ â”£ ğŸ“œcomponent.mk\
 â”ƒ â”ƒ â”£ ğŸ“œenv.mk\
 â”ƒ â”ƒ â”£ ğŸ“œplatform.mk\
 â”ƒ â”ƒ â”£ ğŸ“œrules_r4_TI_COMPILER.mk\
 â”ƒ â”ƒ â”£ ğŸ“œrules_r5f.mk\
 â”ƒ â”ƒ â”£ ğŸ“œrules_r5f_CLANG.mk\
 â”ƒ â”ƒ â”£ ğŸ“œrules_r5f_DIAB.mk\
 â”ƒ â”ƒ â”— ğŸ“œrules_r5f_TI_COMPILER.mk\
 â”ƒ â”£ ğŸ“œccs_makefile\
 â”ƒ â”£ ğŸ“œmakefile\
 â”ƒ â”— ğŸ“œRules.make\
 â”£ ğŸ“‚mcal\
 â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”ƒ â”£ ğŸ“‚include\
 â”ƒ â”ƒ â”£ ğŸ“‚src\
 â”ƒ â”ƒ â”£ ğŸ“‚Vx\
 â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”£ ğŸ“‚autosar_include\
 â”ƒ â”£ ğŸ“‚examples\
 â”ƒ â”ƒ â”£ ğŸ“‚ModuleName\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚soc\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleNameApp.c\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œModuleNameApp.h\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”ƒ â”£ ğŸ“‚Utils\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”£ ğŸ“‚examples_config\
 â”ƒ â”£ ğŸ“‚include\
 â”ƒ â”£ ğŸ“œmcal_component.mk\
 â”£ ğŸ“‚mcal_config\
 â”£ ğŸ“‚mcal_docs\
 â”— ğŸ“œREADME.txt

- **makefile at Root level**

Invoke configuration parameters, internal make files of libraries and examples of different modules for building the source code.

- **Rules.make**

Dependent details for the Makefile to execute like Path for compiler, library, configurations are provided in Rules.mak. Default values for build environment, compiler and SOC are defined here. The build environment/Compiler/SOC will be chosen as Windows/CLANG/am263 if the user has not specified any. Rules.mak shall be included in the Makefile at Root level.

- **mcal_component.mk**

Contains the mcal_libs and mcal_examples list which is build as part of building libs and examples respectively. The user can add or delete MCAL components that need to be built.

- **Makefile at MCAL driver level**

All the source and header files of respective modules are included in the Module makefile to support build.

### Build Steps

This section describes how to build the MCAL package. The package is built using â€œgmakeâ€ from Cygwin.
Make sure that the Cygwin tools location is added to the PATH variable.
Also, make file internally uses some binaries like rm, mkdir, echo etc. from Cygwin.
Standard CCS installation comes with Cygwin, gmake and other utils as required to build MCAL modules.

Edit the **Rules. Make** file present in **<MCAL_INSTALL_PATH>/build/Rules.make** to give the appropriate paths for the tool chains and the current working directory. Make sure that CCS_PATH, and the TOOLCHAIN_PATH_R5 are updated with the proper path.

Edit paths for the below variables according to your system environment

1.In case of windows machine edit CCS path according to CCS version,

- CCS_PATH := C:/ti/ccs1250/ccs
- TOOLCHAIN_PATH_R5 := $(CCS_PATH)/Compilers/ti-cgt-armllvm_2.1.3.LTS

2.In case of Linux machine edit CCS path according to CCS version,

- CCS_PATH := /opt/ti/ccs1250/ccs
- TOOLCHAIN_PATH_R5 := $(CCS_PATH)/Compilers/ti-cgt-armllvm_2.1.3.LTS

3.By default the above are for CLANG compiler, modify respective paths accordingly for using other compilers.

4.Install dependencies required for MCELF image format\
Install Python3\
Install Pip\
Make sure pyelftools and construct is installed from pip. This package is required for encrypting MCELF application images.\
pip install pyelftools construct\
Install openssl v3 from here [https://slproweb.com/products/Win32OpenSSL.html](https://slproweb.com/products/Win32OpenSSL.html)

By default, MCAL package provides pre-generated config headers under
**<MCAL_INSTALL_PATH>/examples_config/\<Module>_Demo_Cfg/soc/\<SOC>/\<Core>/include.**

**\<SOC>** should be with the following value(s): **am263** in folder structure.

Go to **\<MCAL_INSTALL_PATH>/build** directory and type below commands:

Description|Commands|
-----------------------------------|-------------------------------------------|
Command to build all the libraries | gmake -s all PLATFORM=am263 |
Command to build an application given in examples folder | gmake -s <app_name> PLATFORM=am263 <br><br> **app_name** can be found in the make file of the respective examples folder.|
Command to clean all targets  | gmake -s clean PLATFORM=am263 |
Command to clean individual targets  | gmake -s $(target)_clean PLATFORM=am263 |

### Build Platform

PLATFORM makefile macro can take the name of the SOC which needs to be build.
The possible values are as below

- am263
- am263px
- am261

If no value is mentioned explicitly, it will take the default value as am263.

### Build Profiles

MCAL package can be built in two profiles:

- Release Profile
- Debug Profile

Users can build in mode by setting parameter PROFILE while building.

**gmake all PLATFORM=am263 PROFILE=<release/debug>**

PROFILE makefile macro can take either of the following values:

- release for Release Profile
- debug for Debug Profile

If PROFILE is not set during build, MCAL will be built for release profile by default.

To build all the examples and libraries in debug mode, you can give the following command.

**gmake -s all PLATFORM=am263 PROFILE=debug**

Similarly, PROFILE can be set in all the above build commands.

### Multicore ELF Image Format

```{Note}
  By default, MCELF is OFF.  User can enable it with the macro MCELF_ENABLE (yes/no) as yes.

  Give the following command to enable MCELF: 

  gmake -s dio_app MCELF_ENABLE=yes

```

Multicore ELF, or MCELF is a new application image format different from the existing RPRC format. Unlike a proprietary format like RPRC, multicore elf is based on the widely recognized ELF (Executable and Linkable format) standard. This ensures seamless compatibility with industry-standard tools and platforms.\
For more information on ELF format please refer: [https://man7.org/linux/man-pages/man5/elf.5.html](https://man7.org/linux/man-pages/man5/elf.5.html)\
For more information on MCELF image format please refer: [AM263x MCU SDK: Understanding Multicore ELF image format](https://software-dl.ti.com/mcu-plus-sdk/esd/AM263X/latest/exports/docs/api_guide_am263x/MCELF_LANDING.html)

### Code Composer Studio (CCS)

#### Importing projects into CCS

ğŸ“¦AM263x\
 â”£ ğŸ“‚build\
 â”£ ğŸ“‚mcal\
 â”ƒ â”£ ğŸ“‚autosar_include\
 â”ƒ â”£ ğŸ“‚examples\
 â”ƒ â”ƒ â”£ ğŸ“‚Can\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚soc\
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚am263\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚r5f0_0\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚ti-arm-clang\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œcan_app.projectspec  :  *Project template which can be imported into CCS*\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCanApp_Startup.c\
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCanApp_Startup.h\
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCanApp.c\
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œMakefile\
 â”ƒ â”ƒ â”£ ğŸ“‚Utils\
 â”ƒ â”£ ğŸ“‚examples_config\
 â”ƒ â”£ ğŸ“‚include\
 â”£ ğŸ“‚mcal_config\
 â”£ ğŸ“‚mcal_docs\
 â”— ğŸ“œREADME.txt

Every AM263x MCAL example comes with a projectspec file which can be imported in CCS.

1. Open CCS and select Import Project -

    ```{figure} Assets/images/mcaluserguide/CCS_Import_Step1.png
    :alt: CCS Import Step 1
    :align: center


    CCS Import Step 1
    ```

2. Browse to the folder containing Projectspec file and select the desired CCS Project to be imported.

    ```{figure} Assets/images/mcaluserguide/CCS_Import_Step2.png
    :alt: CCS Import Step 2
    :align: center


    CCS Import Step 2
    ```

3. Once project is imported you can continue to build and debug the project.

    ```{figure} Assets/images/mcaluserguide/CCS_Import_Step3.png
    :alt: CCS Project Imported
    :align: center


    CCS Project Imported
    ```

#### Loading generated executable file using CCS

1. Import any example project to CCS, right click on the xer5f file and select 'Debug as Code Composer Debug Session'.

    ```{figure} Assets/images/mcaluserguide/CCS_Loading_Executable_Step1.png
    :alt: CCS Loading Executable Step1
    :align: center


    CCS Loading Executable Step1
    ```

2. Right click on the Texas Instruments XDS110 USB Debug Probe/Cortex_R5_0  and 'Connect Target'.

    ```{figure} Assets/images/mcaluserguide/CCS_Loading_Executable_Step2.png
    :alt: CCS Loading Executable Step2
    :align: center


    CCS Loading Executable Step2
    ```

3. Go to Run - Load - Load Program.

    ```{figure} Assets/images/mcaluserguide/CCS_Loading_Executable_Step3.png
    :alt: CCS Loading Executable Step3
    :align: center


    CCS Loading Executable Step3
    ```

4. Browse to the folder containing the generated executable, select the desired executable to be loaded and click on OK.

    ```{figure} Assets/images/mcaluserguide/CCS_Loading_Executable_Step4.png
    :alt: CCS Loading Executable Step4
    :align: center


    CCS Loading Executable Step4
    ```

5. Once the executable is loaded you can continue to run and debug the project.

```{Note}
For more information on projectspec and it's use in CCS [refer documentation](https://software-dl.ti.com/ccs/esd/documents/ccs_projectspecs.html).
```

#### Building and Debugging projects in CCS

```{Note}
For information on how to build and debug any project in CCS [refer documentation](https://software-dl.ti.com/ccs/esd/documents/users_guide_ccs/index_project-management.html).
```

## Information on the AM263x device family

The AM263x Sitara ArmÂ® Microcontrollers are built to meet the complex real-time processing and control needs
of next generation industrial and automotive embedded projects. AM263x uniquely combines advanced compute
with industry leading real-time control peripherals to meet the growing performance needs of applications such
as HEV/EV (traction inverters, on-board chargers, and DC-DC converters), motor drives, renewable energy,
energy storage, and other general real-time constrained systems. AM263x combines up to four Cortex-R5F
MCUs, a real-time control subsystem (CONTROLSS), a Hardware Security Module (HSM), and one instance of
Sitara's Programmable Real-Time Unit Subsystem (PRU-ICSS), making AM263x designed for advanced motor
control and digital power control applications.

The ARM Dual-Core Cortex-R5F processor subsystem (R5FSS) supports the following main features:

- Armv7-R architecture
- Support Dual Core mode,  Single Core mode and  Lockstep mode
- Full-precision Floating Point (VFPv3)
- 8/16-region Memory Protection Unit (MPU)
- 8 breakpoints, 8 watch points
- CoreSight Debug Access Port (DAP)
- CoreSight ETM-R5 interface (CTI, ETM, ATB)
- Performance Monitoring Unit (PMU)
- Integrated Vectored Interrupt Manager (VIM) per core with 256 Interrupt Inputs each

## Boot Modes

```{Note}
--This section has more details on AM263X-CC. This is mainly for reference.
Make sure boot mode switch is setup to NOBOOT mode to use with CCS.
```

### QSPI BOOT MODE

#### AM263X-CC

This mode is used to boot flashed applications via EVM flash like QSPI flash.

BOOTMODE [ 1 : 4 ] (SW3) = 0010

```{figure} Assets/images/mcaluserguide/BootMode1.png
:alt: QSPI BOOT MODE
:align: center


QSPI BOOT MODE
```

### UARTBOOT MODE

#### AM263X-CC

This mode is used to flash files to the EVM flash via UART. It can also be used to boot applications via UART.

BOOTMODE [ 1 : 4 ] (SW3) = 1000

```{figure} Assets/images/mcaluserguide/boot_pins_uart_mode.png
:alt: UART BOOT MODE
:align: center


UART BOOT MODE
```

### NOBOOT MODE

#### AM263X-CC

This mode is used in CCS.

 BOOTMODE [ 1 : 4 ] (SW3) = 1101

```{figure} Assets/images/mcaluserguide/NoBootMode1.png
:alt: NO BOOT MODE
:align: center


NO BOOT MODE
```

## Running the examples

Connect the CC or EVM board to your computer through JTag (USB Port)

- Before running the binary file on target H/W follow the steps mentioned below:
- Launch CCS, Go to View > Target Configuration
- Create a new target configuration
- Give a nice name to the new target configuration, typically {SOC name} _ {JTAG type}
- Select connection as XDS110 USB Debug Probe
- In "Board or Device" type "@VAR_SOC_NAME" and select "AM263x"
- Click "Save" to save the newly created target configuration.
- Under Advanced tab â€“ Select Cortex_R5_0
- Make sure the device gel file path is in the Initialization script field (C:ti/ccs1250/ccs/ccs_base/emulation/gel/AM263x/AM263x.gel)
- Click "Save" to save the newly created target configuration
- Launch the target configuration for AM263x
- Connect to Cortex_R5_0 core
- Connect UART USB cable to the serial UART terminal (with appropriate port) and select UART1 serial port for viewing the UART logs and providing user input. By default, configuration may be matched by selecting baud rate as 115200, 8-bit Data Size, Parity None and 1 Stop Bit as the serial port settings.
- Load binary files using Load Program option
- Run the application and follow the prompts and output on CCS console/UART serial console.
